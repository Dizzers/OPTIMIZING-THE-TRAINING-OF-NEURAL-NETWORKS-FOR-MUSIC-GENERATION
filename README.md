# OPTIMIZING THE TRAINING OF NEURAL NETWORKS FOR MUSIC GENERATION
course work
# Music Generation with Neural Networks

## Описание проекта

Этот проект посвящен задаче генерации музыки с использованием нейронных сетей. Модель обучается предсказывать следующее состояние музыкальной матрицы (piano-roll) на основе предыдущих временных шагов. Задача представляет собой многомерную многометочную бинарную классификацию, где необходимо определить, какие ноты будут активны на следующем временном шаге.

## Ключевые особенности

- **Генерация музыкальных последовательностей**: Модель генерирует полифоническую музыку в формате MIDI
- **Архитектура**: Комбинированная нейросетевая архитектура на основе сверточных (Conv1D) и рекуррентных слоёв (GRU)
- **Оптимизация обучения**: Основной фокус работы - исследование различных оптимизаторов и функций потерь для преодоления проблем разреженности данных

## Структура данных

### Формат piano-roll
- **Размерность**: T × N (T = 128 временных шагов, N = 84 ноты)
- **Диапазон нот**: MIDI-ноты с 24 по 108
- **Тип данных**: Бинарная матрица (0/1, где 1 - активная нота)
- **Разреженность**: Менее 2% активных нот на временном шаге

### Датасет
- **Объем**: 292 MIDI-файла, содержащих примерно 705 тысяч нот
- **Препроцессинг**:
  1. Парсинг MIDI-файлов с помощью `pretty_midi`
  2. Приведение к фиксированной частоте дискретизации
  3. Извлечение бинарных матриц активности нот
  4. Обрезка/дополнение до фиксированной длины (128 шагов)
  5. Нормализация и батчирование

## Эксперименты

### Исследуемые подходы

#### Оптимизаторы:
- **Adam** - стандартный адаптивный метод оптимизации
- **AdamW** - Adam с decay весов для улучшения регуляризации
- **RMSprop** - адаптивный метод с учетом истории градиентов

#### Функции потерь:
- **Binary Cross-Entropy (BCE)** - стандартная функция для бинарной классификации
- **Focal Loss** - модификация BCE с фокусом на сложных примерах, помогает при дисбалансе классов

### Цель экспериментов
Сравнение эффективности различных комбинаций оптимизаторов и функций потерь для:
1. Повышения стабильности обучения
2. Ускорения сходимости модели
3. Улучшения качества генерации музыки
4. Преодоления проблемы разреженности данных

